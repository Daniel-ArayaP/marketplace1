{"ast":null,"code":"import { Path, Server } from '../../../config';\nimport { Sweetalert, Tooltip } from '../../../functions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/users.service\";\nimport * as i2 from \"@angular/common/http\";\n\nfunction AccountProfileComponent_aside_0_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41)(1, \"select\", 42)(2, \"option\", 43);\n    i0.ɵɵtext(3, \"1\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"option\", 43);\n    i0.ɵɵtext(5, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"option\", 43);\n    i0.ɵɵtext(7, \"3\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"option\", 43);\n    i0.ɵɵtext(9, \"4\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"option\", 44);\n    i0.ɵɵtext(11, \"5\");\n    i0.ɵɵelementEnd()()();\n  }\n}\n\nfunction AccountProfileComponent_aside_0_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 45);\n    i0.ɵɵtext(1, \"Change Password\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AccountProfileComponent_aside_0_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"div\", 47)(2, \"div\", 48)(3, \"a\", 49)(4, \"h1\");\n    i0.ɵɵelement(5, \"i\", 50);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"h4\", 36);\n    i0.ɵɵtext(7, \"Orders \");\n    i0.ɵɵelementStart(8, \"span\", 51);\n    i0.ɵɵtext(9, \"51\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(10, \"div\", 47)(11, \"div\", 48)(12, \"a\", 49)(13, \"h1\");\n    i0.ɵɵelement(14, \"i\", 52);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"h4\", 36);\n    i0.ɵɵtext(16, \"Products \");\n    i0.ɵɵelementStart(17, \"span\", 51);\n    i0.ɵɵtext(18, \"51\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(19, \"div\", 47)(20, \"div\", 48)(21, \"a\", 49)(22, \"h1\");\n    i0.ɵɵelement(23, \"i\", 53);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"h4\", 36);\n    i0.ɵɵtext(25, \"Disputes \");\n    i0.ɵɵelementStart(26, \"span\", 51);\n    i0.ɵɵtext(27, \"51\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(28, \"div\", 47)(29, \"div\", 48)(30, \"a\", 49)(31, \"h1\");\n    i0.ɵɵelement(32, \"i\", 54);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"h4\", 36);\n    i0.ɵɵtext(34, \"Messages \");\n    i0.ɵɵelementStart(35, \"span\", 51);\n    i0.ɵɵtext(36, \"51\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n}\n\nfunction AccountProfileComponent_aside_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"aside\", 27)(1, \"div\", 28)(2, \"div\", 29);\n    i0.ɵɵelement(3, \"img\", 30);\n    i0.ɵɵelementStart(4, \"div\", 31)(5, \"button\", 32);\n    i0.ɵɵelement(6, \"i\", 33);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(7, AccountProfileComponent_aside_0_div_7_Template, 12, 0, \"div\", 34);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 35)(9, \"h2\", 36);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"p\");\n    i0.ɵɵelement(12, \"i\", 37);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵelement(15, \"i\", 38);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(17, AccountProfileComponent_aside_0_button_17_Template, 2, 0, \"button\", 39);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(18, AccountProfileComponent_aside_0_div_18_Template, 37, 0, \"div\", 40);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r0.picture, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.vendor);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.displayName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.username, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.email, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.method);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.vendor);\n  }\n}\n\nfunction AccountProfileComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 55);\n    i0.ɵɵelement(1, \"div\", 56);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AccountProfileComponent_app_account_wishlist_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-account-wishlist\", 57);\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"childItem\", ctx_r2.id);\n  }\n}\n\nexport let AccountProfileComponent = /*#__PURE__*/(() => {\n  class AccountProfileComponent {\n    constructor(usersService, http) {\n      this.usersService = usersService;\n      this.http = http;\n      this.path = Path.url;\n      this.vendor = false;\n      this.method = false;\n      this.preload = false;\n      this.server = Server.url;\n      this.image = null;\n    }\n\n    ngOnInit() {\n      this.preload = true;\n      /*=============================================\r\n      Validar si existe usuario autenticado\r\n      =============================================*/\n\n      this.usersService.authActivate().then(resp => {\n        if (resp) {\n          this.usersService.getFilterData(\"idToken\", localStorage.getItem(\"idToken\")).subscribe(resp => {\n            this.id = Object.keys(resp).toString();\n\n            for (const i in resp) {\n              /*=============================================\r\n              Preguntamos si es vendedor\r\n              =============================================*/\n              if (resp[i].vendor != undefined) {\n                this.vendor = true;\n              }\n              /*=============================================\r\n              Asignamos nombre completo del usuario\r\n              =============================================*/\n\n\n              this.displayName = resp[i].displayName;\n              /*=============================================\r\n              Asignamos username\r\n              =============================================*/\n\n              this.username = resp[i].username;\n              /*=============================================\r\n              Asignamos email\r\n              =============================================*/\n\n              this.email = resp[i].email;\n              /*=============================================\r\n              Asignamos foto del usuario\r\n              =============================================*/\n\n              if (resp[i].picture != undefined) {\n                if (resp[i].method != \"direct\") {\n                  this.picture = resp[i].picture;\n                } else {\n                  this.picture = `assets/img/users/${resp[i].username.toLowerCase()}/${resp[i].picture}`;\n                }\n              } else {\n                this.picture = `assets/img/users/default/default.png`;\n              }\n              /*=============================================\r\n              Método de registro\r\n              =============================================*/\n\n\n              if (resp[i].method != \"direct\") {\n                this.method = true;\n              }\n\n              this.preload = false;\n            }\n          });\n        }\n      });\n      /*=============================================\r\n      Función para ejecutar el Tooltip de Bootstrap 4\r\n      =============================================*/\n\n      Tooltip.fnc();\n      /*=============================================\r\n      Validar formulario de Bootstrap 4\r\n      =============================================*/\n      // Disable form submissions if there are invalid fields\n\n      (function () {\n        'use strict';\n\n        window.addEventListener('load', function () {\n          // Get the forms we want to add validation styles to\n          var forms = document.getElementsByClassName('needs-validation'); // Loop over them and prevent submission\n\n          var validation = Array.prototype.filter.call(forms, function (form) {\n            form.addEventListener('submit', function (event) {\n              if (form.checkValidity() === false) {\n                event.preventDefault();\n                event.stopPropagation();\n              }\n\n              form.classList.add('was-validated');\n            }, false);\n          });\n        }, false);\n      })();\n      /*=============================================\r\n      Script para subir imagen con el input de boostrap\r\n      =============================================*/\n      // Add the following code if you want the name of the file appear on select\n\n\n      $(\".custom-file-input\").on(\"change\", function () {\n        var fileName = $(this).val().split(\"\\\\\").pop();\n        $(this).siblings(\".custom-file-label\").addClass(\"selected\").html(fileName);\n      });\n    }\n    /*=============================================\r\n    Validación de expresión regular del formulario\r\n    =============================================*/\n\n\n    validate(input) {\n      let pattern;\n\n      if ($(input).attr(\"name\") == \"password\") {\n        pattern = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{4,}$/;\n      }\n\n      if (!pattern.test(input.value)) {\n        $(input).parent().addClass('was-validated');\n        input.value = \"\";\n      }\n    }\n    /*=============================================\r\n    Enviar nueva Contraseña\r\n    =============================================*/\n\n\n    newPassword(value) {\n      if (value != \"\") {\n        Sweetalert.fnc(\"loading\", \"Loading...\", null);\n        let body = {\n          idToken: localStorage.getItem('idToken'),\n          password: value,\n          returnSecureToken: true\n        };\n        this.usersService.changePasswordFnc(body).subscribe(resp1 => {\n          let value = {\n            idToken: resp1[\"idToken\"]\n          };\n          this.usersService.patchData(this.id, value).subscribe(resp2 => {\n            /*=============================================\r\n            Almacenamos el Token de seguridad en el localstorage\r\n            =============================================*/\n            localStorage.setItem(\"idToken\", resp1[\"idToken\"]);\n            /*=============================================\r\n            Almacenamos la fecha de expiración localstorage\r\n            =============================================*/\n\n            let today = new Date();\n            today.setSeconds(resp1[\"expiresIn\"]);\n            localStorage.setItem(\"expiresIn\", today.getTime().toString());\n            Sweetalert.fnc(\"success\", \"Password change successful\", \"account\");\n          });\n        }, err => {\n          Sweetalert.fnc(\"error\", err.error.error.message, null);\n        });\n      }\n    }\n    /*=============================================\r\n    Validar Imagen\r\n    =============================================*/\n\n\n    validateImage(e) {\n      this.image = e.target.files[0];\n      /*=============================================\r\n      Validamos el formato\r\n      =============================================*/\n\n      if (this.image[\"type\"] !== \"image/jpeg\" && this.image[\"type\"] !== \"image/png\") {\n        Sweetalert.fnc(\"error\", \"The image must be in JPG or PNG format\", null);\n        return;\n      }\n      /*=============================================\r\n      Validamos el tamaño\r\n      =============================================*/\n      else if (this.image[\"size\"] > 2000000) {\n        Sweetalert.fnc(\"error\", \"Image must not weigh more than 2MB\", null);\n        return;\n      }\n      /*=============================================\r\n      Mostramos la imagen temporal\r\n      =============================================*/\n      else {\n        let data = new FileReader();\n        data.readAsDataURL(this.image);\n        $(data).on(\"load\", function (event) {\n          let path = event.target.result;\n          $(\".changePicture\").attr(\"src\", path);\n        });\n      }\n    }\n    /*=============================================\r\n    Subir imagen al servidor\r\n    =============================================*/\n\n\n    uploadImage() {\n      const formData = new FormData();\n      formData.append('file', this.image);\n      formData.append('folder', this.username);\n      formData.append('path', 'users');\n      formData.append('width', '200');\n      formData.append('height', '200');\n      this.http.post(this.server, formData).subscribe(resp => {\n        if (resp[\"status\"] == 200) {\n          let body = {\n            picture: resp[\"result\"]\n          };\n          this.usersService.patchData(this.id, body).subscribe(resp => {\n            if (resp[\"picture\"] != \"\") {\n              Sweetalert.fnc(\"success\", \"¡Your photo has been updated!\", \"account\");\n            }\n          });\n        }\n      });\n    }\n\n  }\n\n  AccountProfileComponent.ɵfac = function AccountProfileComponent_Factory(t) {\n    return new (t || AccountProfileComponent)(i0.ɵɵdirectiveInject(i1.UsersService), i0.ɵɵdirectiveInject(i2.HttpClient));\n  };\n\n  AccountProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AccountProfileComponent,\n    selectors: [[\"app-account-profile\"]],\n    decls: 45,\n    vars: 4,\n    consts: [[\"class\", \"ps-block--store-banner\", 4, \"ngIf\"], [\"class\", \"d-flex justify-content-center\", 4, \"ngIf\"], [3, \"childItem\", 4, \"ngIf\"], [\"id\", \"newPassword\", 1, \"modal\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"close\"], [1, \"modal-body\"], [\"novalidate\", \"\", 1, \"ps-form--account\", \"ps-tab-root\", \"needs-validation\"], [1, \"form-group\"], [\"type\", \"password\", \"placeholder\", \"Input your new password\", \"name\", \"password\", \"minlength\", \"4\", \"pattern\", \"(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{4,}\", \"data-toggle\", \"tooltip\", \"title\", \"Enter your password with at least 4 characters and must include uppercase, lowercase letters and numbers\", \"required\", \"\", 1, \"form-control\", 3, \"change\"], [\"password\", \"\"], [1, \"valid-feedback\"], [1, \"invalid-feedback\"], [1, \"form-group\", \"submtit\"], [\"type\", \"button\", 1, \"ps-btn\", \"ps-btn--fullwidth\", 3, \"click\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn\", \"btn-danger\"], [\"id\", \"newPicture\", 1, \"modal\"], [1, \"ps-form--account\", \"ps-tab-root\"], [1, \"custom-file\"], [\"type\", \"file\", \"id\", \"customFile\", \"accept\", \"image/*\", \"maxSize\", \"2000000\", 1, \"custom-file-input\", 3, \"change\"], [\"for\", \"customFile\", 1, \"custom-file-label\"], [1, \"text-center\", \"py-3\"], [1, \"img-fluid\", \"rounded-circle\", \"changePicture\", 2, \"width\", \"150px\", 3, \"src\"], [1, \"ps-block--store-banner\"], [1, \"ps-block__user\"], [1, \"ps-block__user-avatar\"], [3, \"src\"], [1, \"br-wrapper\"], [\"data-target\", \"#newPicture\", \"data-toggle\", \"modal\", 1, \"btn\", \"btn-primary\", \"btn-lg\", \"rounded-circle\"], [1, \"fas\", \"fa-pencil-alt\"], [\"class\", \"br-wrapper br-theme-fontawesome-stars mt-3\", 4, \"ngIf\"], [1, \"ps-block__user-content\", \"text-center\", \"text-lg-left\"], [1, \"text-white\"], [1, \"fas\", \"fa-user\"], [1, \"fas\", \"fa-envelope\"], [\"class\", \"btn btn-warning btn-lg\", \"data-target\", \"#newPassword\", \"data-toggle\", \"modal\", 4, \"ngIf\"], [\"class\", \"row ml-lg-auto pt-5\", 4, \"ngIf\"], [1, \"br-wrapper\", \"br-theme-fontawesome-stars\", \"mt-3\"], [\"data-read-only\", \"true\", 1, \"ps-rating\", 2, \"display\", \"none\"], [\"value\", \"1\"], [\"value\", \"2\"], [\"data-target\", \"#newPassword\", \"data-toggle\", \"modal\", 1, \"btn\", \"btn-warning\", \"btn-lg\"], [1, \"row\", \"ml-lg-auto\", \"pt-5\"], [1, \"col-lg-3\", \"col-6\"], [1, \"text-center\"], [\"href\", \"#\"], [1, \"fas\", \"fa-shopping-cart\", \"text-white\"], [1, \"badge\", \"badge-secondary\", \"rounded-circle\"], [1, \"fas\", \"fa-shopping-bag\", \"text-white\"], [1, \"fas\", \"fa-bell\", \"text-white\"], [1, \"fas\", \"fa-comments\", \"text-white\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"spinner-border\", \"text-muted\", \"my-5\"], [3, \"childItem\"]],\n    template: function AccountProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r7 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵtemplate(0, AccountProfileComponent_aside_0_Template, 19, 7, \"aside\", 0);\n        i0.ɵɵtemplate(1, AccountProfileComponent_div_1_Template, 2, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, AccountProfileComponent_app_account_wishlist_2_Template, 1, 1, \"app-account-wishlist\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"div\", 6)(7, \"h4\", 7);\n        i0.ɵɵtext(8, \"New Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"button\", 8);\n        i0.ɵɵtext(10, \"\\u00D7\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"div\", 9)(12, \"form\", 10)(13, \"div\", 11)(14, \"input\", 12, 13);\n        i0.ɵɵlistener(\"change\", function AccountProfileComponent_Template_input_change_14_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r3 = i0.ɵɵreference(15);\n\n          return i0.ɵɵresetView(ctx.validate(_r3));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 14);\n        i0.ɵɵtext(17, \"Valid.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 15);\n        i0.ɵɵtext(19, \"Please fill in this field correctly.\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 16)(21, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function AccountProfileComponent_Template_button_click_21_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r3 = i0.ɵɵreference(15);\n\n          return i0.ɵɵresetView(ctx.newPassword(_r3.value));\n        });\n        i0.ɵɵtext(22, \"Submit\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(23, \"div\", 18)(24, \"button\", 19);\n        i0.ɵɵtext(25, \"Close\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(26, \"div\", 20)(27, \"div\", 4)(28, \"div\", 5)(29, \"div\", 6)(30, \"h4\", 7);\n        i0.ɵɵtext(31, \"New Picture\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"button\", 8);\n        i0.ɵɵtext(33, \"\\u00D7\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(34, \"div\", 9)(35, \"form\", 21)(36, \"div\", 22)(37, \"input\", 23);\n        i0.ɵɵlistener(\"change\", function AccountProfileComponent_Template_input_change_37_listener($event) {\n          return ctx.validateImage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"label\", 24);\n        i0.ɵɵtext(39, \"Choose file\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(40, \"figure\", 25);\n        i0.ɵɵelement(41, \"img\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(42, \"div\", 16)(43, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function AccountProfileComponent_Template_button_click_43_listener() {\n          return ctx.uploadImage();\n        });\n        i0.ɵɵtext(44, \"Submit\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.preload);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.preload);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.preload);\n        i0.ɵɵadvance(39);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.picture, i0.ɵɵsanitizeUrl);\n      }\n    }\n  });\n  return AccountProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}